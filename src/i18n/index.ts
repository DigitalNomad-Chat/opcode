import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import LanguageDetector from 'i18next-browser-languagedetector';

// 中英文翻译（阶段1和2：核心导航和功能页面）
const resources = {
  en: {
    translation: {
      // 输入相关
      'prompt.placeholder': 'Message Claude (@ for files, / for commands)...',
      'send': 'Send',
      'expand': 'Expand (Ctrl+Shift+E)',
      'collapse': 'Collapse',
      'model': 'Model',
      'thinking': 'Thinking',
      'drop.images': 'Drop images here...',

      // 顶部导航和标签
      'projects': 'Projects',
      'settings': 'Settings',
      'agents': 'Agents',
      'usage': 'Usage',
      'mcp': 'MCP',
      'tabs.new': 'New Session',
      'tabs.projects': 'Projects',
      'tabs.settings': 'Settings',
      'tabs.agents': 'Agents',
      'tabs.usage': 'Usage',
      'tabs.mcp': 'MCP',
      'tabs.close': 'Close Tab',
      'tabs.close.all': 'Close All',
      'tabs.close.others': 'Close Others',
      'tabs.unsaved.changes': 'Unsaved changes',
      'tabs.new.project': 'New project (Ctrl+T)',
      'tabs.max.reached': 'Maximum tabs reached',
      'tabs.scroll.left': 'Scroll tabs left',
      'tabs.scroll.right': 'Scroll tabs right',
      'tabs.close.title': 'Close {{title}}',

      // 操作和动作
      'open.project': 'Open Project',
      'new.session': 'New Session',
      'save.settings': 'Save Settings',
      'actions.open': 'Open',
      'actions.close': 'Close',
      'actions.save': 'Save',
      'actions.cancel': 'Cancel',
      'actions.delete': 'Delete',
      'actions.edit': 'Edit',
      'actions.copy': 'Copy',
      'actions.create': 'Create',
      'actions.run': 'Run',
      'actions.stop': 'Stop',
      'actions.pause': 'Pause',
      'actions.resume': 'Resume',
      'actions.export': 'Export',
      'actions.import': 'Import',
      'actions.refresh': 'Refresh',
      'actions.view': 'View',
      'actions.select': 'Select',
      'actions.configure': 'Configure',

      // 设置标签
      'general.settings': 'General Settings',
      'permissions': 'Permissions',
      'environment': 'Environment',
      'advanced': 'Advanced',
      'hooks': 'Hooks',
      'commands': 'Commands',
      'storage': 'Storage',
      'proxy': 'Proxy',
      'agent.settings': 'Agent Settings',

      // 项目相关
      'recent.projects': 'Recent Projects',
      'select.project': 'Select a project to start working with Claude Code',
      'no.recent.projects': 'No recent projects',
      'open.first.project': 'Open Your First Project',
      'new.project': 'New Project',
      'session.count': 'session',
      'sessions': 'sessions',
      'back.to.projects': 'Back to Projects',
      'project.name': 'Project Name',
      'project.path': 'Project Path',
      'project.created': 'Created',
      'project.last.active': 'Last Active',
      'project.session.count': '{{count}} session',
      'project.session.count_plural': '{{count}} sessions',
      'project.select.folder': 'Select Project Folder',

      // 设置相关
      'theme': 'Theme',
      'dark': 'Dark',
      'gray': 'Gray',
      'light': 'Light',
      'custom': 'Custom',
      'claude.installation': 'Claude Installation',
      'select.claude.installation': 'Select which version of Claude to use',
      'install.claude.code': 'Install Claude Code',
      'analytics.enabled': 'Enable Analytics',
      'tab.persistence': 'Remember Open Tabs',
      'startup.intro': 'Show Welcome Intro on Startup',
      'language': 'Language',
      'select.language': 'Select your preferred language',
      'english': 'English',
      'chinese': '中文',
      'settings.saved': 'Settings saved successfully',
      'settings.save.failed': 'Failed to save settings',

      // 主题设置
      'choose.theme': 'Choose your preferred color theme',
      'include.coauthored': 'Include "Co-authored by Claude"',
      'claude.attribution': 'Add Claude attribution to git commits and pull requests',
      'verbose.output': 'Verbose Output',
      'full.command.output': 'Show full bash and command outputs',

      // 聊天相关
      'chat.retention': 'Chat Transcript Retention (days)',
      'chat.retention.desc': 'How long to retain chat transcripts locally (default: 30 days)',
      'chat.new': 'New Chat',
      'chat.loading': 'Loading...',
      'chat.error': 'Error',
      'chat.empty': 'Start a conversation',

      // 智能体相关
      'agents.title': 'Agents',
      'agents.create': 'Create Agent',
      'agents.import': 'Import Agent',
      'agents.export': 'Export Agent',
      'agents.run': 'Run Agent',
      'agents.name': 'Agent Name',
      'agents.description': 'Description',
      'agents.system.prompt': 'System Prompt',
      'agents.tools': 'Tools',
      'agents.running': 'Running',
      'agents.completed': 'Completed',
      'agents.failed': 'Failed',
      'agents.no.agents': 'No agents created yet',
      'agents.create.first': 'Create your first agent',

      // 使用统计
      'usage.title': 'Usage Dashboard',
      'usage.sessions': 'Sessions',
      'usage.messages': 'Messages',
      'usage.tokens': 'Tokens',
      'usage.cost': 'Cost',
      'usage.today': 'Today',
      'usage.this.week': 'This Week',
      'usage.this.month': 'This Month',
      'usage.total': 'Total',

      // MCP管理
      'mcp.title': 'MCP Servers',
      'mcp.add.server': 'Add Server',
      'mcp.remove.server': 'Remove Server',
      'mcp.configure': 'Configure',
      'mcp.name': 'Server Name',
      'mcp.command': 'Command',
      'mcp.args': 'Arguments',
      'mcp.env': 'Environment Variables',
      'mcp.status.connected': 'Connected',
      'mcp.status.disconnected': 'Disconnected',
      'mcp.no.servers': 'No MCP servers configured',

      // 状态和消息
      'status.loading': 'Loading...',
      'status.error': 'Error',
      'status.success': 'Success',
      'status.checking': 'Checking...',
      'status.ready': 'Ready',
      'status.offline': 'Offline',
      'status.online': 'Online',
      'status.coming.soon': 'Coming soon...',

      // 通用词汇
      'common.name': 'Name',
      'common.description': 'Description',
      'common.version': 'Version',
      'common.path': 'Path',
      'common.date': 'Date',
      'common.time': 'Time',
      'common.type': 'Type',
      'common.size': 'Size',
      'common.status': 'Status',
      'common.actions': 'Actions',
      'common.settings': 'Settings',
      'common.configure': 'Configure',

      // 按钮和控件
      'button.ok': 'OK',
      'button.yes': 'Yes',
      'button.no': 'No',
      'button.confirm': 'Confirm',
      'button.apply': 'Apply',
      'button.reset': 'Reset',
      'button.clear': 'Clear',
      'button.browse': 'Browse',
      'button.search': 'Search',
      'button.filter': 'Filter',
      'button.sort': 'Sort',

      // 错误和提示
      'error.load.failed': 'Failed to load data',
      'error.save.failed': 'Failed to save data',
      'error.connection': 'Connection error',
      'error.permission': 'Permission denied',
      'error.not.found': 'Not found',
      'error.invalid.input': 'Invalid input',
      'error.no.agent.id': 'No agent run ID specified',
      'error.no.agent.data': 'No agent data specified',
      'error.no.claude.file.id': 'No Claude file ID specified',
      'error.unknown.tab': 'Unknown tab type: {{type}}',
      'confirm.delete': 'Are you sure you want to delete this item?',
      'confirm.discard': 'Are you sure you want to discard changes?',
    }
  },
  zh: {
    translation: {
      // 输入相关
      'prompt.placeholder': '输入消息 (@文件 /命令)...',
      'send': '发送',
      'expand': '展开 (Ctrl+Shift+E)',
      'collapse': '收起',
      'model': '模型',
      'thinking': '思考模式',
      'drop.images': '拖放图片...',

      // 顶部导航和标签
      'projects': '项目',
      'settings': '设置',
      'agents': '智能体',
      'usage': '使用统计',
      'mcp': 'MCP',
      'tabs.new': '新会话',
      'tabs.projects': '项目',
      'tabs.settings': '设置',
      'tabs.agents': '智能体',
      'tabs.usage': '使用统计',
      'tabs.mcp': 'MCP',
      'tabs.close': '关闭标签页',
      'tabs.close.all': '关闭所有',
      'tabs.close.others': '关闭其他',
      'tabs.unsaved.changes': '未保存的更改',
      'tabs.new.project': '新建项目 (Ctrl+T)',
      'tabs.max.reached': '已达到最大标签页数量',
      'tabs.scroll.left': '向左滚动标签页',
      'tabs.scroll.right': '向右滚动标签页',
      'tabs.close.title': '关闭 {{title}}',

      // 操作和动作
      'open.project': '打开项目',
      'new.session': '新会话',
      'save.settings': '保存设置',
      'actions.open': '打开',
      'actions.close': '关闭',
      'actions.save': '保存',
      'actions.cancel': '取消',
      'actions.delete': '删除',
      'actions.edit': '编辑',
      'actions.copy': '复制',
      'actions.create': '创建',
      'actions.run': '运行',
      'actions.stop': '停止',
      'actions.pause': '暂停',
      'actions.resume': '继续',
      'actions.export': '导出',
      'actions.import': '导入',
      'actions.refresh': '刷新',
      'actions.view': '查看',
      'actions.select': '选择',
      'actions.configure': '配置',

      // 设置标签
      'general.settings': '常规设置',
      'permissions': '权限',
      'environment': '环境变量',
      'advanced': '高级',
      'hooks': '钩子',
      'commands': '命令',
      'storage': '存储',
      'proxy': '代理',
      'agent.settings': '智能体设置',

      // 项目相关
      'recent.projects': '最近项目',
      'select.project': '选择项目以开始使用 Claude Code',
      'no.recent.projects': '没有最近项目',
      'open.first.project': '打开您的第一个项目',
      'new.project': '新建项目',
      'session.count': '个会话',
      'sessions': '个会话',
      'back.to.projects': '返回项目',
      'project.name': '项目名称',
      'project.path': '项目路径',
      'project.created': '创建时间',
      'project.last.active': '最后活跃',
      'project.session.count': '{{count}} 个会话',
      'project.session.count_plural': '{{count}} 个会话',
      'project.select.folder': '选择项目文件夹',

      // 设置相关
      'theme': '主题',
      'dark': '深色',
      'gray': '灰色',
      'light': '浅色',
      'custom': '自定义',
      'claude.installation': 'Claude 安装',
      'select.claude.installation': '选择要使用的 Claude 版本',
      'install.claude.code': '安装 Claude Code',
      'analytics.enabled': '启用分析',
      'tab.persistence': '记住打开的标签页',
      'startup.intro': '启动时显示欢迎介绍',
      'language': '语言',
      'select.language': '选择您的首选语言',
      'english': 'English',
      'chinese': '中文',
      'settings.saved': '设置保存成功',
      'settings.save.failed': '设置保存失败',

      // 主题设置
      'choose.theme': '选择您喜欢的颜色主题',
      'include.coauthored': '包含 "Co-authored by Claude"',
      'claude.attribution': '在 git 提交和拉取请求中添加 Claude 署名',
      'verbose.output': '详细输出',
      'full.command.output': '显示完整的 bash 和命令输出',

      // 聊天相关
      'chat.retention': '聊天记录保留天数',
      'chat.retention.desc': '本地保留聊天记录的时间（默认：30天）',
      'chat.new': '新聊天',
      'chat.loading': '加载中...',
      'chat.error': '错误',
      'chat.empty': '开始对话',

      // 智能体相关
      'agents.title': '智能体',
      'agents.create': '创建智能体',
      'agents.import': '导入智能体',
      'agents.export': '导出智能体',
      'agents.run': '运行智能体',
      'agents.name': '智能体名称',
      'agents.description': '描述',
      'agents.system.prompt': '系统提示词',
      'agents.tools': '工具',
      'agents.running': '运行中',
      'agents.completed': '已完成',
      'agents.failed': '失败',
      'agents.no.agents': '尚未创建智能体',
      'agents.create.first': '创建您的第一个智能体',

      // 使用统计
      'usage.title': '使用统计面板',
      'usage.sessions': '会话数',
      'usage.messages': '消息数',
      'usage.tokens': '令牌数',
      'usage.cost': '费用',
      'usage.today': '今天',
      'usage.this.week': '本周',
      'usage.this.month': '本月',
      'usage.total': '总计',

      // MCP管理
      'mcp.title': 'MCP 服务器',
      'mcp.add.server': '添加服务器',
      'mcp.remove.server': '移除服务器',
      'mcp.configure': '配置',
      'mcp.name': '服务器名称',
      'mcp.command': '命令',
      'mcp.args': '参数',
      'mcp.env': '环境变量',
      'mcp.status.connected': '已连接',
      'mcp.status.disconnected': '已断开',
      'mcp.no.servers': '未配置 MCP 服务器',

      // 状态和消息
      'status.loading': '加载中...',
      'status.error': '错误',
      'status.success': '成功',
      'status.checking': '检查中...',
      'status.ready': '就绪',
      'status.offline': '离线',
      'status.online': '在线',
      'status.coming.soon': '即将推出...',

      // 通用词汇
      'common.name': '名称',
      'common.description': '描述',
      'common.version': '版本',
      'common.path': '路径',
      'common.date': '日期',
      'common.time': '时间',
      'common.type': '类型',
      'common.size': '大小',
      'common.status': '状态',
      'common.actions': '操作',
      'common.settings': '设置',
      'common.configure': '配置',

      // 按钮和控件
      'button.ok': '确定',
      'button.yes': '是',
      'button.no': '否',
      'button.confirm': '确认',
      'button.apply': '应用',
      'button.reset': '重置',
      'button.clear': '清除',
      'button.browse': '浏览',
      'button.search': '搜索',
      'button.filter': '筛选',
      'button.sort': '排序',

      // 错误和提示
      'error.load.failed': '加载数据失败',
      'error.save.failed': '保存数据失败',
      'error.connection': '连接错误',
      'error.permission': '权限被拒绝',
      'error.not.found': '未找到',
      'error.invalid.input': '输入无效',
      'error.no.agent.id': '未指定智能体运行ID',
      'error.no.agent.data': '未指定智能体数据',
      'error.no.claude.file.id': '未指定Claude文件ID',
      'error.unknown.tab': '未知标签类型：{{type}}',
      'confirm.delete': '您确定要删除此项目吗？',
      'confirm.discard': '您确定要放弃更改吗？',
    }
  }
};

i18n
  .use(initReactI18next)
  .use(LanguageDetector)
  .init({
    resources,
    lng: 'zh', // 默认中文
    fallbackLng: 'en',
    interpolation: { escapeValue: false },
    debug: import.meta.env.MODE === "development", // 开发模式下启用调试
    detection: {
      order: ['localStorage', 'navigator', 'htmlTag'],
      caches: ['localStorage'], // 缓存用户选择的语言
      lookupLocalStorage: 'i18nextLng',
    },
    react: {
      useSuspense: false, // 避免Suspense相关的问题
    }
  });

export default i18n;
